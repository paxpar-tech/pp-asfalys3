import{d as H,r as _,R as E,o as j,bG as N,b as c,c as r,e as o,Y,n as q,g as S,F as u,a1 as v,t as f,w as z,j as F,cm as k,O as P}from"./entry.1b7ba420.js";import{_ as W}from"./debug-panel.vue.aa68d9bc.js";import{u as O}from"./useToast.2a8aaca6.js";import"./useFeatureFlag.75c805c4.js";const X={class:"stack w-full"},I=["innerHTML"],J={class:"flex"},K=o("p",null,"page",-1),Q=["onClick"],U=o("h1",null,"SVG load done test",-1),Z=o("h1",null,"loaded SVG",-1),tt={class:"pl-4"},et={class:"pl-4"},nt={class:"pl-4"},ot=20,M=1e3,st=1e3,rt=H({__name:"pages",props:{href:{}},setup(G){const p=G,{$fetch2:V}=F(),y=_(),b=_(),$=_(),d=_({node:void 0,pages:[]}),g=_(!0),C=O();E(p,async(t,e)=>{await w()}),E(g,async(t,e)=>{console.log("autoplay",{newValue:t,oldValue:e})}),j(async()=>{await w()});const w=async()=>{if(p.href)try{var t=await V(p.href,{parseResponse:e=>e});y.value=t,setTimeout(A)}catch{C.error(`Erreur lors de la récupération de l'animation ${p.href}`)}};function T(t){D(t);const e=d.value.node;k(e,{initial:{opacity:0,x:500},enter:{opacity:1,x:0,transition:{duration:M}}}),d.value.node.setAttribute("viewBox",t.viewBox)}function D(t){t.stages.forEach((e,h)=>{e.nodes.forEach((s,l)=>{k(s,{initial:{opacity:0,y:100},enter:{opacity:1,y:0,transition:{delay:M+h*st}}})})})}const A=()=>{const t=b.value.querySelector("svg"),e={node:t,pages:[]};t.children[0].children.forEach((l,a)=>{const n=t.createSVGRect();n.x=l.getAttribute("x"),n.y=l.getAttribute("y"),n.width=l.getAttribute("width"),n.height=l.getAttribute("height");const i={rect:n,viewBox:`${n.x} ${n.y} ${n.width} ${n.height}`,stages:[]};e.pages.push(i)});for(var s=1;s<=ot;s++)t.querySelectorAll(`svg [ref='stage${s}']`).forEach((a,n)=>{e.pages.forEach((i,B)=>{const m=L(a.getBBox(),i.rect),x=a.getBBox(),R=i.rect;if(console.log({stage:s,inPage:m,nodeBBox:x,pageRect:R}),m){for(;i.stages.length<s;)i.stages.push({nodes:[]});i.stages[s-1].nodes.push(a)}})});d.value=e,$.value=t,t.setAttribute("width","100%"),t.setAttribute("height","100%"),console.log("deck_info",d.value)};function L(t,e){const h=t.width+e.width,s=t.height+e.height,l=Math.max(Math.abs(e.x+e.width-t.x),Math.abs(t.x+t.width-e.x)),a=Math.max(Math.abs(e.y+e.height-t.y),Math.abs(t.y+t.height-e.y));return l<h&&a<s}return(t,e)=>{const h=P,s=W,l=N("motion-fade");return c(),r(u,null,[o("div",X,[Y(o("div",{ref_key:"container",ref:b,class:"object-contain w-full",innerHTML:y.value},null,8,I),[[l]])]),o("div",null,[o("div",J,[o("button",{onClick:e[0]||(e[0]=a=>g.value=!g.value),class:q(["btn btn-circle",g.value?"btn-outline":""])},[S(h,{name:"pajamas:autoplay",size:"32"})],2),K,(c(!0),r(u,null,v(d.value.pages,(a,n)=>(c(),r("button",{onClick:i=>T(a),class:"btn px-2 m-1"},f(n+1),9,Q))),256))])]),S(s,null,{default:z(()=>[U,o("button",{class:"btn",onClick:A},"loadSVG2"),Z,o("ul",tt,[(c(!0),r(u,null,v(d.value.pages,(a,n)=>(c(),r(u,null,[o("li",null,"page "+f(n+1),1),o("ul",et,[(c(!0),r(u,null,v(a.stages,(i,B)=>(c(),r(u,null,[o("li",null,"stage "+f(B+1),1),o("ul",nt,[(c(!0),r(u,null,v(i.nodes,(m,x)=>(c(),r("li",null,"node "+f(x+1),1))),256))])],64))),256))])],64))),256))])]),_:1})],64)}}});export{rt as default};
